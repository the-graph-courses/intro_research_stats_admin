---
title: 'Descriptive Statistics 2: Measures of Central Tendency'
format:
  html:
    embed-resources: true
---

```{r, echo = F, message = F, warning = F}
# Load packages
if (!require(pacman)) install.packages("pacman")
pacman::p_load(rlang, tidyverse, knitr, here, reactable, gt, flextable)

# Source functions
source(here("global/functions/lesson_functions.R"))

# Knitr options
knitr::opts_chunk$set(
  warning = F, message = F,
  class.source = "tgc-code-block", error = T
)

# Set ggplot theme
theme_set(theme_minimal())
```

------------------------------------------------------------------------

# Introduction {.unnumbered}

In this lesson, we explore **Measures of Central Tendency** for numeric variables: Mean, Median, Mode.

# Learning Objectives {.unnumbered}

By the end of this lesson, you will be able to:

1.  Compute and interpret measures of central tendency (mean, median, mode) in R.
2.  Know which ones are appropriate for what.

# Packages

This lesson will require the following packages to be installed and loaded:

```{r warning = F, message = F}
# Load packages
if (!require(pacman)) install.packages("pacman")
pacman::p_load(
  tidyverse,
  here,
  janitor,
  DescTools,
  inspectdf
)
```

------------------------------------------------------------------------

# Recap: Methods of Descriptive analysis

Descriptive analysis of numerical variables can be measured by different methods (numerical or graphical) depending on the type of variable being summarized.

EDIT TO SHOW WHAT'S BEEN COVERED ALREADY. REORDER AND USE SAME ORDER IN LAST LESSON.

1.  **Numerical Variables**
    -   **Continuous**
        -   **Numerical methods** (e.g., mean, median, variance)
        -   **Graphical methods** (e.g., histogram, boxplot)
    -   **Discrete**
        -   **Numerical methods** (e.g., counts, proportions, discrete distributions)
        -   **Graphical methods** (e.g., bar charts, histograms with integer bins)
2.  **Categorical Variables**
    -   **Ordinal** (clear order, e.g., Likert scale: *poor*, *fair*, *good*)
        -   **Numerical methods** (e.g., frequencies, percentages)
        -   **Graphical methods** (e.g., bar chart with ordered categories)
    -   **Nominal** (no inherent order, e.g., gender, country)
        -   **Numerical methods** (e.g., frequencies, proportions)
        -   **Graphical methods** (e.g., bar chart, pie chart)

::: callout-tip
## Key Point

There are both **numerical** and **graphical** methods we can use to perform descriptive analysis for all types and subtypes of variables.

![](images/flowchart_full.png)

HIGHLIGHT/CIRCLE THE CONTINUOUS NUMERICAL RECTANGE.
:::

# The Yaounde COVID-19 dataset

```{r message = F}
# Import data to RStudio
yaounde <- read_csv(here("data/yaounde_data.csv"))
```

```{r render = .reactable_5_rows, echo = F}
yaounde
```

```{r render = .reactable_5_rows}
head(yaounde)
```

# Numerical Variables

In previous sections you've seen methods for describing categorical variables. Now we'll switch over to describing numerical variables, both numerically and graphically.

## Numerical Descriptions of Numerical Variables: Measures of Central Tendency

![](images/flowchart_num_numerical.png)

In epidemiology, we often want to describe the "typical" person in a population with respect to some characteristic that is recorded as a numerical variable – like height or weight. The most basic, and probably most commonly used, way to do so is with a **measure of central tendency**.

![](images/central_tendency_01.png)

In this chapter we'll discuss three measures of central tendency:

-   **The mean**: The arithmetic average of the values.
-   **The median**: The middle value when data are sorted.
-   **The mode**: The most frequently occurring value(s).

UPDATE WITH THE FOSSA DEFINITIONS.

Each of these have advantages and disadvantages, summarized in the chart below.

![](images/central_tendency_04.png)

::: callout-tip
## Key Point

Measures of central tendency summarize the "center" of a numerical distribution. They are sometimes referred to as measures of "location" (?). In public health, these measures help describe typical patient outcomes, average disease rates, and other key indicators.
:::

::: callout-note
## Practice

**Measures of Central Tendency**

We measured the BMI of a group of individuals. Can you identify the median from the following values: 25, 24, 31, 38, 18, 14, 16, 25, 22, 25, 24, 27, 42, 30, 32?
:::

### Mean

**Mean** is the sum of all the values in the data set divided by the number of values in the data set. It is also called the arithmetic average. The **sample mean** is denoted as x̅ and is read as **x bar**.

The formula to calculate the mean is:

![](images/Mean-(1).png)

We can perform this calculation with the `mean()` function from base R.

```{r}
# Demonstration using a single numerical variable: "height_cm"
mean_height <- mean(yaounde$height_cm)
mean_height
```

::: callout-warning
## Notation Alert

The **sample mean** is denoted by the Latin letter $\bar{x}$.

The **population mean** is denoted by the Greek letter $\mu$.

This will become important in later steps when we calculate standard deviation, standard error, confidence intervals, and more.
:::

### Median

A Median is a middle value for sorted data. The sorting of the data can be done either in ascending order or descending order. A median divides the data into two halves.

The formula to calculate the **median** of the number of terms if the number of terms is even is shown in the image below:

![](images/median-even-number.png)

The formula to calculate the median of the number of terms if the number of terms is odd is shown in the image below:

![](images/median-odd-number.png)

We can perform this calculation with the `median()` function from base R.

```{r}
median_height <- median(yaounde$height_cm)
median_height
```

### Mode

A mode is the most frequent value or item of the data set. There is no mode for a data set if every number appears only once.

![](images/Mode-(1).png)

Base R does not have a built-in function for calculating the mode, so we can use the `Mode()` function from the `{DescTools}` package.

```{r}
Mode(yaounde$height_cm)
```

::: callout-warning
## Missing values when calculating measures of central tendency

If there are missing values you can exclude them by adding `na.rm = TRUE`

```{r}
# Returns NA because there are missing values in this column
mean(yaounde$n_bedridden_days)
```

```{r}
# Sucessfully calculates the mean
mean(yaounde$n_bedridden_days, na.rm = TRUE)
```

The same applies to the `median()` and `Mode()` functions.
:::

::: callout-note
## Practice

**Calculating Measures of Central Tendency in R**

Use `mean()`, `median()`, and `Mode()` from `{DescTools}` to compute the following:

1.  Mean of `weight_kg`.

```{r include = F}
"YOUR ANSWER HERE"
```

2.  Median of `n_days_miss_work` (be sure to handle missing values).

```{r include = F}
"YOUR ANSWER HERE"
```

3.  Mode of `height_cm` and `n_bedridden_days`.

```{r include = F}
"YOUR ANSWER HERE"
```
:::

### Differences between Mean, Median, and Mode

Mean, median, and mode are measures of central tendency in statistics.

| **Feature** | **Mean** | **Median** | **Mode** |
|:----------------:|:----------------:|:----------------:|:----------------:|
| **Definition** | Mean is the average of all values. | The median is the middle value when data is sorted. | Mode is the most frequently occurring value in the dataset. |
| **Sensitivity** | The mean is sensitive to outliers. | The median is not sensitive to outliers. | The mode is not sensitive to outliers. |
| **Calculation** | Calculated by adding up all values of a dataset and dividing them by the total number of values in the dataset. | Calculated by finding the middle value in a list of data. | Calculated by finding which value occurs more number of times in a dataset. |
| **Representation** | The value of the mean may or may not be in the dataset. | Value of the median is always a value from the dataset. | The value of the mode is also always a value from the dataset. |

# Graphing measures of central tendency

```{r}
# Simple histogram showing the distribution of height_cm
ggplot(
  data = yaounde,
  mapping = aes(x = height_cm)
) +
  geom_histogram(
    color = "white",
    fill = "steelblue", binwidth = 5
  ) +
  scale_x_continuous(
    breaks = scales::pretty_breaks(n = 12),
    expand = c(0, 0)
  ) +
  scale_y_continuous(expand = c(0, 0)) +
  geom_vline(aes(xintercept = median(height_cm)),
    linetype = "dashed", linewidth = 1
  )  +
  geom_vline(aes(xintercept = mean(height_cm)),
    linetype = "dotted", linewidth = 1, color = "red"
  )
```

What if we filter out the children and plot the histogram again?

```{r}
# Create new df of only adults
yao_adults <- yaounde %>% filter(age_category_3 != "Child")

# Define base ggplot layers
yao_adults_height <- ggplot(
  data = yao_adults,
  mapping = aes(x = height_cm)
) +
  scale_x_continuous(
    breaks = scales::pretty_breaks(n = 12),
    expand = c(0, 0)
  ) +
  scale_y_continuous(expand = c(0, 0))

yao_adults_height +
  geom_histogram(
    color = "white",
    fill = "steelblue",
    binwidth = 5
  )  +
  geom_vline(aes(xintercept = median(height_cm)),
    linetype = "dashed", linewidth = 1
  )  +
  geom_vline(aes(xintercept = mean(height_cm)),
    linetype = "dotted", linewidth = 1, color = "red"
  )
```

-   We can also represent continuous distributions with a smoothed curve, which is a useful alternative to the histogram.
-   We can use a curve to approximate the histogram by plotting it on top of the bars.

```{r}
yao_adults_height +
  geom_histogram(
    bins = 50,
    color = "white",
    fill = "dodgerblue",
    mapping = aes(y = after_stat(density))
  ) +
  geom_density(
    color = "indianred2",
    alpha = 0.25,
    linewidth = 1,
    bw = 3
  ) +
  geom_vline(aes(xintercept = mean(height_cm)),
    linetype = "dashed", linewidth = 1
  ) +
  geom_vline(aes(xintercept = median(height_cm)),
    linetype = "dotted", linewidth = 1, color = "red"
  )
```

```{r}
# Comparing distributions across sub categories
ggplot(yaounde, aes(x = age_category_3, y = height_cm,
    fill = age_category_3,
    shape = sex)) +
  geom_boxplot() +
  stat_summary(
    fun = "mean",
    geom = "point",
    size = 2,
    #shape = 23,
    fill = "white"
  ) +
  facet_wrap(~sex)

# Density curves mirrored on the sides
ggplot(yaounde, aes(x = age_category_3, y = height_cm,
    fill = age_category_3,
    shape = sex)) +
  geom_violin() +
  stat_summary(
    fun = "mean",
    geom = "point",
    size = 2,
    #shape = 23,
    fill = "white"
  ) +
  facet_wrap(~sex)
```

# Symmetry and Skew

## Identifying skew

\[ADD EXPLANTORY TEXT\]

Identifying skew (non-normality) in the data is important because our choice of statistical tests depends on the distribution of the data.

-   When continuous data are (approximately) normally distributed, we use **parametric tests** such as t-tests, ANOVA, Pearson correlation.

-   Otherwise we use **non-parametric tests** such as Mann-Whitney U test, Kruskal-Wallis test, chi-square test.

## Assessing symmetry

1.  Visual tests – EXAMPLE OF HIST AND BOXPLOT NEXT TO EACH OTHER - BOTH SHOW SKEW

2.  Summary statistics

    -   Median similar to mean

    -   SD \> mean?

    -   Coefficient of skewness

![](images/clipboard-2950650358.webp)

When normal, distribution can be summarized by mean and standard deviation. If not, median or mode may be more appropriate.

::: callout-tip
## Transforming data

TRANSFORMATIONS – NOT RELEVANT for this course rn, but quick side note that you can transform to get the mean and CIs, and then back transform to original scale.
:::

------------------------------------------------------------------------

# Key Takeaways {.unnumbered}

-   **Descriptive analysis** begins with identifying **variable types**: numerical vs. categorical, then diving deeper (continuous, discrete, ordinal, nominal).
-   **Measures of central tendency** (mean, median, mode) can be used to describe the "center" of a numeric distribution. Each have unique properties:
    -   **Mean** is sensitive to outliers.
    -   **Median** is more robust to skewness.
    -   **Mode** is always an observed value, but may not be unique or might not exist in certain distributions.
-   **Graphical summaries** (histograms, kernel density curves, boxplots) reveal patterns not always evident from numerical summaries alone.

Continue exploring these concepts with real-world data to gain deeper insight into public health analyses.

SOMETHING HERE ABOUT INVESTIGATING DATA BEFORE DOING ANALYSIS. PLOTTING AND SUMMARY STATISTICS SHOULD COME FIRST.

------------------------------------------------------------------------

# Answer Key {.unlisted .unnumbered}

**Caculating Measures of Central Tendency in R**

Use `mean()`, `median()`, and `Mode()` from `{DescTools}` to compute the following:

1.  Mean of `weight_kg`.

```{r}
mean(yaounde$weight_kg)
```

2.  Median of `n_days_miss_work` (be sure to handle missing values).

```{r}
mean(yaounde$n_days_miss_work, na.rm = TRUE)
```

3.  Mode of `height_cm` and `n_bedridden_days`.

```{r}
Mode(yaounde$height_cm)

Mode(yaounde$n_bedridden_days, na.rm = T)
```

# Appendix: R functions used in this lesson {.unlisted .unnumbered}

-   **Data Import & Setup**
    -   **`read_csv()`**\
        Reads CSV files into a data frame (from the **readr** package).
    -   **`here()`**\
        Constructs file paths relative to the project's root (from the **here** package).
-   **Data Exploration & Inspection**
    -   **`glimpse()`**\
        Displays the structure of a data frame in a compact format (from **dplyr**/**tibble**).
    -   **`data()`**\
        Loads built-in or package datasets.
    -   **`head()`**\
        Shows the first few rows of a data frame.
-   **Data Manipulation & Summary**
    -   **`%>%`**\
        The pipe operator for chaining operations (from **magrittr** or **dplyr**).
    -   **`tabyl()`**\
        Creates frequency tables, showing counts (and can compute percentages) for categorical variables (from the **janitor** package).
    -   **`adorn_percentages()`**\
        Adds percentage calculations to frequency tables (from the **janitor** package).
-   **Descriptive Statistics**
    -   **`mean()`**\
        Computes the arithmetic mean.
    -   **`median()`**\
        Computes the median.
    -   **`Mode()`**\
        Calculates the mode (from the **DescTools** package).
-   **Data Visualization (using ggplot2)**
    -   **`ggplot()`**\
        Initializes a ggplot object.
    -   **`aes()`**\
        Sets up aesthetic mappings in ggplot2 plots.
    -   **`geom_bar()`**\
        Creates bar charts.
    -   **`geom_histogram()`**\
        Creates histograms.
    -   **`geom_density()`**\
        Creates kernel density plots.
    -   **`geom_boxplot()`**\
        Creates boxplots.
    -   **`geom_jitter()`**\
        Adds jittered points to a plot to show individual observations.
    -   **`stat_summary()`**\
        Adds summary statistics (e.g., mean markers) as a layer in a plot.
    -   **`reorder()`**\
        Reorders factor levels based on another variable (a base R function often used within aesthetic mappings).

# Contributors {.unlisted .unnumbered}

The following team members contributed to this lesson:

`r .tgc_contributors_list(ids = c("joy", "kendavidn"))`

# References {.unlisted .unnumbered}

Some material in this lesson was adapted from the following sources:

-   Irizarry, Rafael A. 2019. *Introduction to Data Science: Statistics and Prediction Algorithms Through Case Studies*. <https://rafalab.dfci.harvard.edu/dsbook-part-2/>.
-   Cannell, Brad, and Melvin Livingston. n.d. *R for Epidemiology*. <https://www.r4epi.com/>.
-   GeeksforGeeks. 2025. "Introduction of Statistics and Its Types." <https://www.geeksforgeeks.org/introduction-of-statistics-and-its-types/>.
-   Starmer, Josh. *StatQuest with Josh Starmer* \[YouTube Channel\]. <https://www.youtube.com/channel/UCtYLUTtgS3k1Fg4y5tAhLbw>.
-   The GRAPH Courses. *FoSSA: Fundamentals of Statistical Software & Analysis*. <https://thegraphcourses.org/courses/fossa/>.
-   University of Miami Libraries. *Introduction to Data Analysis and R*. <https://www.library.miami.edu/data-services/data-analysis.html>.

`r .tgc_license()`
