---
title: 'Descriptive Statistics 1 & 2: Measures of Central Tendency'
format: html
---

```{r, echo = F, message = F, warning = F}
# Load packages
if (!require(pacman)) install.packages("pacman")
pacman::p_load(rlang, tidyverse, knitr, here, reactable, gt, flextable)

# Source functions
source(here("global/functions/lesson_functions.R"))

# Knitr options
knitr::opts_chunk$set(
  warning = F, message = F,
  class.source = "tgc-code-block", error = T
)

# Set ggplot theme
theme_set(theme_minimal())
```

------------------------------------------------------------------------

# Introduction {.unnumbered}

In this lesson, we explore the fundamental concepts of **descriptive analysis**, focusing on:

-   **Types of Variables**: Numerical (continuous, discrete) and Categorical (ordinal, nominal)
-   **Measures of Central Tendency**: Mean, Median, Mode
-   **Basic Numerical and Graphical Summaries** for each type

# Learning Objectives {.unnumbered}

By the end of this lesson, you will be able to:

1.  Identify numerical and categorical variables and their subtypes.
2.  Compute and interpret measures of central tendency (mean, median, mode).
3.  Create appropriate numerical and graphical summaries for different variable types using R.

# Packages

This lesson will require the following packages to be installed and loaded:

```{r warning = F, message = F}
# Load packages
if (!require(pacman)) install.packages("pacman")
pacman::p_load(
  tidyverse,
  here,
  janitor,
  DescTools,
  inspectdf
)
```

------------------------------------------------------------------------


# Recap: Methods of Descriptive analysis

Descriptive analysis of numerical variables can be measured by different methods (numerical or graphical) depending on the type of variable being summarized.

1.  **Numerical Variables**
    -   **Continuous**
        -   **Numerical methods** (e.g., mean, median, variance)
        -   **Graphical methods** (e.g., histogram, boxplot)
    -   **Discrete**
        -   **Numerical methods** (e.g., counts, proportions, discrete distributions)
        -   **Graphical methods** (e.g., bar charts, histograms with integer bins)
2.  **Categorical Variables**
    -   **Ordinal** (clear order, e.g., Likert scale: *poor*, *fair*, *good*)
        -   **Numerical methods** (e.g., frequencies, percentages)
        -   **Graphical methods** (e.g., bar chart with ordered categories)
    -   **Nominal** (no inherent order, e.g., gender, country)
        -   **Numerical methods** (e.g., frequencies, proportions)
        -   **Graphical methods** (e.g., bar chart, pie chart)

::: callout-tip
## Key Point

There are both **numerical** and **graphical** methods we can use to perform descriptive analysis for all types and subtypes of variables.

![](images/flowchart_full.png)
:::


# The Yaounde COVID-19 dataset



```{r message = F}
# Import data to RStudio
yaounde <- read_csv(here("data/yaounde_data.csv"))
```

```{r render = .reactable_5_rows, echo = F}
yaounde
```



```{r render = .reactable_5_rows}
head(yaounde)
```



# Categorical Variables

We'll start by describing categorical variables, both numerically and graphically. As a reminder, categorical variables are variables whose values fit into distinct categories.

## Numerical Descriptions of Categorical Variables

We'll begin our discussion of descriptive statistics in the categorical half of our flow chart. Specifically, we'll start by numerically describing categorical variables.

![](images/flowchart_cat_numerical.png)

The two most common numerical descriptions of categorical variables are probably the **frequency count** (you will often hear this referred to as simply the frequency, the count, or the n) and the **proportion or percentage** (the percentage is just the proportion multiplied by 100).

Using the `tabyl()` function from the `{janitor}` package, we can make frequency tables displaying the frequencies and percentages of categorical variable(s).

```{r}
# Make a frequency table of the `is_smoker` variable.
yaounde %>% tabyl(is_smoker)
```

The count (`n` column) is simply the number of observations, in this case deaths, which fall into each possible category.

The proportion (`percentage` column) is just the count divided by the total number of observations. In this example, almost 9 out of 10 deaths (.87 or 87%) died in a hospital or clinic.

We can also use the `tabyl()` function to create 2-way frequency tables.

```{r}
# Create a summary data frame of two categorical variables
yaounde %>%
  tabyl(is_smoker, sex)
yaounde %>%
  tabyl(is_smoker, sex) %>%
  adorn_percentages("row")
```

::: callout-note
## Practice

**Frequency Tables**

Use the `tabyl()` function from the `{janitor}` package to answer the following:

1.  Create a frequency table of `has_contact_covid`.

```{r include = F}
"YOUR ANSWER HERE"
```

2.  Create a two-way frequency table between `has_contact_covid` and `igg_result`.

```{r include = F}
"YOUR ANSWER HERE"
```

3.  Use `adorn_percentages("row")` to display row-wise proportions in the table created above.

```{r include = F}
"YOUR ANSWER HERE"
```
:::


# Numerical Variables

In previous sections you've seen methods for describing categorical variables. Now we'll switch over to describing numerical variables, both numerically and graphically.

## Numerical Descriptions of Numerical Variables: Measures of Central Tendency

![](images/flowchart_num_numerical.png)

In epidemiology, we often want to describe the "typical" person in a population with respect to some characteristic that is recorded as a numerical variable – like height or weight. The most basic, and probably most commonly used, way to do so is with a **measure of central tendency**.

![](images/clipboard-2679901684.png)

In this chapter we'll discuss three measures of central tendency:

-   **The mean**: The arithmetic average of the values.
-   **The median**: The middle value when data are sorted.
-   **The mode**: The most frequently occurring value(s).

Each of these have advantages and disadvantages, summarized in the chart below.

![](images/central_tendency_04.png)

::: callout-tip
## Key Point

Measures of central tendency summarize the "center" of a numerical distribution. In public health, these measures help describe typical patient outcomes, average disease rates, and other key indicators.
:::

::: callout-note
## Practice

**Measures of Central Tendency**

We measured the BMI of a group of individuals. Can you identify the median from the following values: 25, 24, 31, 38, 18, 14, 16, 25, 22, 25, 24, 27, 42, 30, 32?
:::

### Mean

**Mean** is the sum of all the values in the data set divided by the number of values in the data set. It is also called the Arithmetic Average. The Mean is denoted as x̅ and is read as **x bar**.

The formula to calculate the mean is:

![](images/Mean-(1).png)

We can perform this calculation with the `mean()` function from base R.

```{r}
# Demonstration using a single numerical variable: "height_cm"
mean_height <- mean(yaounde$height_cm)
mean_height
```

### Median

A Median is a middle value for sorted data. The sorting of the data can be done either in ascending order or descending order. A median divides the data into two halves.

The formula to calculate the **median** of the number of terms if the number of terms is even is shown in the image below:

![](images/median-even-number.png)

The formula to calculate the median of the number of terms if the number of terms is odd is shown in the image below:

![](images/median-odd-number.png)

We can perform this calculation with the `median()` function from base R.

```{r}
median_height <- median(yaounde$height_cm)
median_height
```

### Mode

A mode is the most frequent value or item of the data set. There is no mode for a data set if every number appears only once.

![](images/Mode-(1).png)

Base R does not have a built-in function for calculating the mode, so we can use the `Mode()` function from the `{DescTools}` package.

```{r}
Mode(yaounde$height_cm)
```

::: callout-warning
## Missing values when calculating measures of central tendency

If there are missing values you can exclude them by adding `na.rm = TRUE`

```{r}
# Returns NA because there are missing values in this column
mean(yaounde$n_bedridden_days)
```

```{r}
# Sucessfully calculates the mean
mean(yaounde$n_bedridden_days, na.rm = TRUE)
```

The same applies to the `median()` and `Mode()` functions.
:::

::: callout-note
## Practice

**Calculating Measures of Central Tendency in R**

Use `mean()`, `median()`, and `Mode()` from `{DescTools}` to compute the following:

1.  Mean of `weight_kg`.

```{r include = F}
"YOUR ANSWER HERE"
```

2.  Median of `n_days_miss_work` (be sure to handle missing values).

```{r include = F}
"YOUR ANSWER HERE"
```

3.  Mode of `height_cm` and `n_bedridden_days`.

```{r include = F}
"YOUR ANSWER HERE"
```
:::

### Differences between Mean, Median, and Mode

Mean, median, and mode are measures of central tendency in statistics.

| **Feature** | **Mean** | **Median** | **Mode** |
|:----------------:|:----------------:|:----------------:|:----------------:|
| **Definition** | Mean is the average of all values. | The median is the middle value when data is sorted. | Mode is the most frequently occurring value in the dataset. |
| **Sensitivity** | The mean is sensitive to outliers. | The median is not sensitive to outliers. | The mode is not sensitive to outliers. |
| **Calculation** | Calculated by adding up all values of a dataset and dividing them by the total number of values in the dataset. | Calculated by finding the middle value in a list of data. | Calculated by finding which value occurs more number of times in a dataset. |
| **Representation** | The value of themean may or may not be in the dataset. | Value of the median is always a value from the dataset. | The value of the mode is also always a value from the dataset. |

------------------------------------------------------------------------



# Key Takeaways {.unnumbered}

-   **Descriptive analysis** begins with identifying **variable types**: numerical vs. categorical, then diving deeper (continuous, discrete, ordinal, nominal).
-   **Measures of central tendency** (mean, median, mode) each have unique properties:
    -   **Mean** is sensitive to outliers.
    -   **Median** is more robust to skewness.
    -   **Mode** is always an observed value, but may not be unique or might not exist in certain distributions.
-   **Graphical summaries** (histograms, boxplots, bar charts) reveal patterns not always evident from numerical summaries alone.

Continue exploring these concepts with real-world data to gain deeper insight into public health analyses.

------------------------------------------------------------------------

# Answer Key {.unlisted .unnumbered}

**Identifying Variable Types**

For the four variables below, select whether it is numerical or categorical. If categorical, specify if it's ordinal or nominal. If numerical, classify as discrete or continuous.

1.  Stress level, responses are "high", "medium", "low". **Categorical – Ordinal**
2.  Age in years. **Numerical – Discrete**
3.  Height in centimeters. **Numerical – Continuous**
4.  Country name. **Categorical – Nominal**

**Identifying Variable Types**

If I measure age (in years) in a sample of 10,000 women, what type of variable would this be classified as? **Discrete**

**Identifying Variable Types and R Data Classes**

1.  `age` – **Numerical (Discrete), R class: Numeric**\
2.  `highest_education` – **Categorical (Ordinal), R class: Character or Factor**\
3.  `is_smoker` – **Categorical (Nominal), R class: Character**\
4.  `date_surveyed` – **Date, R class: Date**\
5.  `weight_kg` – **Numerical (Continuous), R class: Numeric**\
6.  `igg_result` – **Categorical (Nominal), R class: Character**

R data classes correspond to different variable types:

| Variable Type | R Data Class      | Example Variables in Yaounde Dataset |
|---------------|-------------------|--------------------------------------|
| Continuous    | Numeric           | `height_cm`, `weight_kg`             |
| Discrete      | Integer, Numeric  | `age`, `n_days_miss_work`            |
| Ordinal       | Factor (ordered)  | `highest_education`                  |
| Nominal       | Factor, Character | `sex`, `neighborhood`                |
| Logical       | Logical           | `is_pregnant`, `is_medicated`        |
| Date          | Date              | `date_surveyed`                      |

**Frequency Tables**

Use the `tabyl()` function from the `{janitor}` package to answer the following:

1.  Create a frequency table of `has_contact_covid`.

```{r}
yaounde %>% tabyl(has_contact_covid)
```

2.  Create a two-way frequency table between `has_contact_covid` and `igg_result`.

```{r}
yaounde %>% tabyl(
  has_contact_covid,
  igg_result
)
```

3.  Use `adorn_percentages("row")` to display row-wise proportions in the table created above.

```{r}
yaounde %>%
  tabyl(
    has_contact_covid,
    igg_result
  ) %>%
  adorn_percentages("row")
```

**Bar Charts**

Use `ggplot()` to create the following charts:

1.  Plot a bar chart showing the distribution of `age_category_3`, colored by `is_smoker`.

```{r}
ggplot(yaounde) +
  geom_bar(aes(x = age_category_3, fill = is_smoker))
```

2.  Create a percent-stacked bar chart showing the same variables.

```{r}
ggplot(yaounde) +
  geom_bar(aes(x = age_category_3, fill = is_smoker),
    position = "fill"
  )
```

3.  Reorder the `age_category_3` factor so that the categories appear in the logical order and then plot again.

```{r}
# Reorder categories from youngest to oldest
yaounde <- yaounde %>%
  mutate(
    age_category_3_ordered =
      factor(age_category_3,
        levels = c(
          "Child",
          "Adult",
          "Senior"
        )
      )
  )
```

```{r}
# Plot again with the ordered variable
ggplot(yaounde) +
  geom_bar(
    aes(
      x = age_category_3_ordered,
      fill = is_smoker
    ),
    position = "fill"
  )
```

**Caculating Measures of Central Tendency in R**

Use `mean()`, `median()`, and `Mode()` from `{DescTools}` to compute the following:

1.  Mean of `weight_kg`.

```{r}
mean(yaounde$weight_kg)
```

2.  Median of `n_days_miss_work` (be sure to handle missing values).

```{r}
mean(yaounde$n_days_miss_work, na.rm = TRUE)
```

3.  Mode of `height_cm` and `n_bedridden_days`.

```{r}
Mode(yaounde$height_cm)

Mode(yaounde$n_bedridden_days, na.rm = T)
```

**Histograms**

-   Plot a histogram showing the distribution of `n_bedridden_days` in `yaounde`.

```{r}
ggplot(
  data = yaounde,
  mapping = aes(x = n_bedridden_days)
) +
  geom_histogram(fill = "steelblue")
```

Make notes on these key questions:

1.  What are the smallest and largest values?
2.  What are frequent and infrequent values?

-   Smallest value is 0.\
-   Largest may be 30, but it is an outlier.\
-   Most frequent value is 0.\
-   Distribution is heavily left-skewed, with most patients having no or very few bedridden days.

**Density Plot: weight by sex**

-   Plot a kernel density plot showing the distribution of weight for each sex in `yaounde`.

```{r}
ggplot(yaounde, aes(weight_kg,
  colour = sex,
  fill = sex
)) +
  geom_density(alpha = 0.1)
```

-   Shows typical weight slightly differs by sex.\
-   Distributions largely overlap.
-   Distribution is bimodal - with two peaks. Perhaps one for children and one for adults.
-   Males have a slightly higher central tendency.

**Boxplots**

-   Create a boxplot showing the distribution of weights for each sex. Improve the plot by adding a layer of jittered points and a marker for the mean.

```{r}
"YOUR ANSWER HERE"

ggplot(
  yaounde,
  aes(
    x = sex,
    y = weight_kg,
    fill = sex,
    color = sex
  )
) +
  geom_boxplot(alpha = 0.6) +
  geom_jitter(width = 0.25, alpha = 0.5) +
  stat_summary(
    fun = "mean",
    geom = "point",
    size = 3,
    shape = 23,
    fill = "white"
  )
```

**Graphical methods for numeric variables**

We measured the age of 10,000 women in the UK. How would you suggest we look at the distribution of age across the sample population?

1.  Produce a bar chart, with age across the x-axis and frequency on the y-axis
2.  Produce a frequency table with all the ages in ascending order
3.  **Produce a histogram using age**
4.  Produce a bar chart, with age across the x-axis and gender across the y-axis
5.  Produce two histograms using age, one for men and one for women

# Appendix: R functions used in this lesson {.unlisted .unnumbered}

-   **Data Import & Setup**
    -   **`read_csv()`**\
        Reads CSV files into a data frame (from the **readr** package).
    -   **`here()`**\
        Constructs file paths relative to the project's root (from the **here** package).
-   **Data Exploration & Inspection**
    -   **`glimpse()`**\
        Displays the structure of a data frame in a compact format (from **dplyr**/**tibble**).
    -   **`data()`**\
        Loads built-in or package datasets.
    -   **`head()`**\
        Shows the first few rows of a data frame.
-   **Data Manipulation & Summary**
    -   **`%>%`**\
        The pipe operator for chaining operations (from **magrittr** or **dplyr**).
    -   **`tabyl()`**\
        Creates frequency tables, showing counts (and can compute percentages) for categorical variables (from the **janitor** package).
    -   **`adorn_percentages()`**\
        Adds percentage calculations to frequency tables (from the **janitor** package).
-   **Descriptive Statistics**
    -   **`mean()`**\
        Computes the arithmetic mean.
    -   **`median()`**\
        Computes the median.
    -   **`Mode()`**\
        Calculates the mode (from the **DescTools** package).
-   **Data Visualization (using ggplot2)**
    -   **`ggplot()`**\
        Initializes a ggplot object.
    -   **`aes()`**\
        Sets up aesthetic mappings in ggplot2 plots.
    -   **`geom_bar()`**\
        Creates bar charts.
    -   **`geom_histogram()`**\
        Creates histograms.
    -   **`geom_density()`**\
        Creates kernel density plots.
    -   **`geom_boxplot()`**\
        Creates boxplots.
    -   **`geom_jitter()`**\
        Adds jittered points to a plot to show individual observations.
    -   **`stat_summary()`**\
        Adds summary statistics (e.g., mean markers) as a layer in a plot.
    -   **`reorder()`**\
        Reorders factor levels based on another variable (a base R function often used within aesthetic mappings).

# Contributors {.unlisted .unnumbered}

The following team members contributed to this lesson:

`r .tgc_contributors_list(ids = c("joy", "kendavidn"))`

# References {.unlisted .unnumbered}

Some material in this lesson was adapted from the following sources:

-   Irizarry, Rafael A. 2019. *Introduction to Data Science: Statistics and Prediction Algorithms Through Case Studies*. <https://rafalab.dfci.harvard.edu/dsbook-part-2/>.
-   Cannell, Brad, and Melvin Livingston. n.d. *R for Epidemiology*. <https://www.r4epi.com/>.
-   GeeksforGeeks. 2025. "Introduction of Statistics and Its Types." <https://www.geeksforgeeks.org/introduction-of-statistics-and-its-types/>.
-   Starmer, Josh. *StatQuest with Josh Starmer* \[YouTube Channel\]. <https://www.youtube.com/channel/UCtYLUTtgS3k1Fg4y5tAhLbw>.
-   The GRAPH Courses. *FoSSA: Fundamentals of Statistical Software & Analysis*. <https://thegraphcourses.org/courses/fossa/>.
-   University of Miami Libraries. *Introduction to Data Analysis and R*. <https://www.library.miami.edu/data-services/data-analysis.html>.

`r .tgc_license()`
